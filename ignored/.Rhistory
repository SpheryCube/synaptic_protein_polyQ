theme_classic()
?scale_y_contiuous
scale_y_continuous
?scale_y_continuous
# https://stackoverflow.com/questions/41907260/scale-geom-density-to-match-geom-bar-with-percentage-on-y
ggplot(RandomProteins, aes(x = Qfraction)) +
stat_bin(aes(y=..density..), breaks = seq(min(RandomProteins$Qfraction), max(RandomProteins$Qfraction), by = .1), color="white") +
geom_line(stat="density", size = 1) +
scale_y_continuous(labels = scales::percent, name = "percent") +
theme_classic()
library(scales)
# Count
p <- ggplot(data = RandomProteins, aes(x = Qfraction)) +
geom_histogram() +
scale_y_continuous(labels = percent, name = "percent") +
plot(p)
# Count
p <- ggplot(data = RandomProteins, aes(x = Qfraction)) +
geom_histogram() +
scale_y_continuous(labels = percent, name = "percent")
plot(p)
# Count
p <- ggplot(data = RandomProteins, aes(x = Qfraction)) +
geom_histogram(aes(y = ..density..)) +
scale_y_continuous(labels = percent, name = "percent")
plot(p)
# Count
p <- ggplot(data = RandomProteins, aes(x = Qfraction)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels = percent)
plot(p)
# Count
p <- ggplot(data = RandomProteins, aes(x = Qfraction)) +
geom_density(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels = percent)
plot(p)
# Count
p <- ggplot(data = RandomProteins, aes(x = Qfraction)) +
geom_density(aes(y = (..count..)/sum(..count..))) +
geom_histogram(aes(y = (..count..)/sum(..count..)))
scale_y_continuous(labels = percent)
# Count
p <- ggplot(data = RandomProteins, aes(x = Qfraction)) +
geom_density(aes(y = (..count..)/sum(..count..))) +
geom_histogram(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels = percent)
plot(p)
# Count
p <- ggplot(data = RandomProteins, aes(x = Qfraction)) +
geom_density(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels = percent)
plot(p)
# Count
p <- ggplot(data = RandomProteins, aes(x = Qfraction)) +
geom_density(aes(y = (..count..)/sum(..count..))) +
geom_histogram(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels = percent)
plot(p)
# Count
p <- ggplot(data = RandomProteins, aes(x = Qfraction)) +
geom_density(aes(y = (..count..)/sum(..count..))) +
geom_histogram(aes(y = (..count..)/sum(..count..)), bins = 10) +
scale_y_continuous(labels = percent)
plot(p)
# Count
p <- ggplot(data = RandomProteins, aes(x = Qfraction)) +
geom_density(aes(y = (..count..)/sum(..count..))) +
geom_histogram(aes(y = (..count..)/sum(..count..)), bins = 5) +
scale_y_continuous(labels = percent)
plot(p)
# Count
p <- ggplot(data = RandomProteins, aes(x = Qfraction)) +
geom_density(aes(y = (..count..)/sum(..count..))) +
geom_histogram(aes(y = (..count..)/sum(..count..)), bins = 100) +
scale_y_continuous(labels = percent)
plot(p)
# Count
p <- ggplot(data = RandomProteins, aes(x = Qfraction)) +
geom_density(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels = percent)
plot(p)
##################################################
# Get data
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 100)
search_summary <- entrez_summary(db = "protein", search$ids)
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
a <- t(a)
colnames(a) <- c("AccessionNumber", "ProteinName")
write.csv(a, file="RandomProteins.csv")
a
##################################################
# Analyze Data
RandomProteins = analyzeProteins("RandomProteins.csv", minPolyQLength = 30, PolyQThreshold = 0.2)
##################################################
# Get data
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 10000)
search_summary <- entrez_summary(db = "protein", search$ids)
##################################################
# Get data
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 1000)
search_summary <- entrez_summary(db = "protein", search$ids)
search$ids
search_summary <- entrez_summary(db = "protein", search$ids)
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", use_history = TRUE)
search
search$web_history
search_summary <- entrez_summary(db = "protein", web_history = search$web_history$WebEnv)
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", use_history = TRUE)
search_summary <- entrez_summary(db = "protein", web_history = search$web_history)
##################################################
# Get data
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 1000)
search_summary <- entrez_summary(db = "protein", search$ids)
##################################################
# Get data
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 20)
search_summary <- entrez_summary(db = "protein", search$ids)
##################################################
# Get data
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 20)
search
search$ids
search_summary <- entrez_summary(db = "protein", search$ids)
search_summary
extract_from_esummary(search_summary, c("caption", "title"))
table(extract_from_esummary(search_summary, c("caption", "title")))
View(table(extract_from_esummary(search_summary, c("caption", "title"))))
##################################################
# Get data
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 20)
search_summary <- entrez_summary(db = "protein", search$ids)
knitr::table(extract_from_esummary(search_summary, c("caption", "title")))
knitr::kable(extract_from_esummary(search_summary, c("caption", "title")))
a <- knitr::kable(extract_from_esummary(search_summary, c("caption", "title")))
a
View(a)
a <- as.data.frame(extract_from_esummary(search_summary, c("caption", "title")))
View(a)
a <- t(as.data.frame(extract_from_esummary(search_summary, c("caption", "title"))))
View(a)
##################################################
# Get data
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 20)
search_summary <- entrez_summary(db = "protein", search$ids)
a <- t(as.data.frame(extract_from_esummary(search_summary, c("caption", "title"))))
View(a)
##################################################
# Get data
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 20)
search_summary <- entrez_summary(db = "protein", search$ids)
a <- t(as.data.frame(extract_from_esummary(search_summary, c("caption", "title"))))
a
a
View(a)
class(a)
unlist(a)
a
View(a)
View(unlist(a))
##################################################
# Get data
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 20)
search_summary <- entrez_summary(db = "protein", search$ids)
a <- t(as.data.frame(extract_from_esummary(search_summary, c("caption", "title"))))
a
View(a)
##################################################
# Get data
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 20)
search_summary <- entrez_summary(db = "protein", search$ids)
a <- t(knitr::kable(extract_from_esummary(search_summary, c("caption", "title"))))
View(a)
a <- knitr::kable(extract_from_esummary(search_summary, c("caption", "title")))
View(a)
class(a)
a <- knitr::kable(extract_from_esummary(search_summary, c("caption", "title")))
a
a <- (extract_from_esummary(search_summary, c("caption", "title")))
a
View(a)
##################################################
# Get data
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 20)
search_summary <- entrez_summary(db = "protein", search$ids)
search_summary
##################################################
# Get data
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 1000)
search
##################################################
# Get data
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 135644)
search
upload <- entrez_post(db="protein", id = search$ids)
search
##################################################
# Get data
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]", retmax = 135644, use_history = TRUE)
upload <- entrez_post(db="protein", id = search$ids)
search
search$web_history
# search$web_history
upload <- entrez_post(db="protein", id = search$ids)
##################################################
# Get data
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]", retmax = 135644, use_history = TRUE)
# search$web_history
upload <- entrez_post(db="protein", id = search$ids)
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]", retmax = 135644, use_history = TRUE)
search_summary <- entrez_summary(db = "protein", web_history = search$web_history)
search_summary <- entrez_summary(db = "protein", search$ids, web_history = search$web_history)
search$ids
search_summary <- entrez_summary(db = "protein", search$ids, web_history = search$web_history)
search_summary <- entrez_summary(db = "protein",  web_history = search$web_history)
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]", retmax = 135644, use_history = TRUE)
search
search_summary <- entrez_summary(db = "protein", web_history = search$web_history)
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", use_history = TRUE)
search_summary <- entrez_summary(db = "protein", web_history = search$web_history)
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 5)
search
search_summary <- entrez_summary(db = "protein", ids = search$ids)
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 5)
search_summary <- entrez_summary(db = "protein", id = search$ids)
search_summary
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = 135644, use_history = TRUE)
search_summary <- entrez_summary(db = "protein")
search$web_history$QueryKey
upload <- entrez_post(db="protein", search$ids)
search$web_history$WebEnv
class(search$web_history$WebEnv)
cat(search$web_history$WebEnv)
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = 135644, use_history = TRUE)
upload <- entrez_post(db="protein", search$ids)
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 5, use_history = TRUE)
search_summary <- entrez_summary(db = "protein", web_history = search$web_history)
############### THis stuff down here works
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 5)
search_summary <- entrez_summary(db = "protein", id = search$ids)
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 5, use_history = TRUE)
search_summary <- entrez_summary(db = "protein", web_history = search$web_history)
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 5, use_history = TRUE)
search_summary <- entrez_summary(db = "protein", web_history = search$web_history)
search$web_history
search_summary <- entrez_summary(db = "protein", web_history = search$web_history, retmax = 10)
search_summary
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 10, use_history = TRUE)
search_summary <- entrez_summary(db = "protein", web_history = search$web_history, retmax = 10)
search_summary
matrix(3, 3)
?matrix
x <- as.data.frame(matrix(NA, nrow = 1, ncol =3 ))
x
x <- as.data.frame(matrix(NA, nrow = 1, ncol =3 ))
for (seq_start in seq(1, 200, 50))
{
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = 50, retstart = seq_start)
search_summary <- entrez_summary(db = "protein", id = search$ids)
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
a <- t(a)
colnames(a) <- c("AccessionNumber", "ProteinName")
rbind(x, a)
}
x <- as.data.frame(matrix(NA, nrow = 1, ncol =2 ))
for (seq_start in seq(1, 200, 50)) {
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = 50, retstart = seq_start)
search_summary <- entrez_summary(db = "protein", id = search$ids)
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
a <- t(a)
colnames(a) <- c("AccessionNumber", "ProteinName")
rbind(x, a)
}
x
a
View(a)
ta.frame(matrix(NA, nrow = 1, ncol =2 ))
colnames(x
x <- as.data.frame(matrix(NA, nrow = 1, ncol =2 ))
colnames(x) <- c("AccessionNumber", "ProteinName")
x <- as.data.frame(matrix(NA, nrow = 1, ncol =2 ))
colnames(x) <- c("AccessionNumber", "ProteinName")
View(x)
x <- as.data.frame(matrix(NA, nrow = 0, ncol =2 ))
colnames(x) <- c("AccessionNumber", "ProteinName")
View(x)
for (seq_start in seq(1, 200, 50)) {
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = 50, retstart = seq_start)
search_summary <- entrez_summary(db = "protein", id = search$ids)
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
a <- t(a)
rbind(x, a)
}
View(x)
a
rbind(x, a)
for (seq_start in seq(1, 200, 50)) {
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = 50, retstart = seq_start)
search_summary <- entrez_summary(db = "protein", id = search$ids)
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
a <- t(a)
x <- rbind(x, a)
}
View(x)
#for (seq_start in seq(1, 200, 50)) {
result <- foreach(seq_start = seq(1, 200, 50), .combine = rbind) %dopar% {
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = 50, retstart = seq_start)
search_summary <- entrez_summary(db = "protein", id = search$ids)
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
a <- t(a)
a
}
#for (seq_start in seq(1, 200, 50)) {
result <- foreach(seq_start = seq(1, 200, 50), .combine = rbind) %do% {
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = 50, retstart = seq_start)
search_summary <- entrez_summary(db = "protein", id = search$ids)
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
a <- t(a)
a
}
result
View(result)
colnames(result) <- c("AccessionNumber", "ProteinName")
View(result)
result
class(result)
result <- as.data.frame(result)
colnames(result) <- c("AccessionNumber", "ProteinName")
length(unique(result$AccessionNumber))
result <- foreach(seq_start = seq(1, 200, 100), .combine = rbind) %do% {
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = 50, retstart = seq_start)
search_summary <- entrez_summary(db = "protein", id = search$ids)
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
a <- t(a)
a
}
result <- foreach(seq_start = seq(1, 500, 500), .combine = rbind) %do% {
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = 50, retstart = seq_start)
search_summary <- entrez_summary(db = "protein", id = search$ids)
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
a <- t(a)
a
}
result
View(result)
result <- foreach(seq_start = seq(1, 500, 500), .combine = rbind) %do% {
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = 500, retstart = seq_start)
search_summary <- entrez_summary(db = "protein", id = search$ids)
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
a <- t(a)
a
}
max <- 100
result <- foreach(seq_start = seq(1, 500, max), .combine = rbind) %do% {
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = max, retstart = seq_start)
search_summary <- entrez_summary(db = "protein", id = search$ids)
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
a <- t(a)
a
}
max <- 200
result <- foreach(seq_start = seq(1, 3600, max), .combine = rbind) %do% {
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = max, retstart = seq_start)
search_summary <- entrez_summary(db = "protein", id = search$ids)
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
a <- t(a)
a
}
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 300, use_history = TRUE)
search_summary <- entrez_summary(db = "protein", web_history = search$web_history, retmax = 300)
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 500, use_history = TRUE)
search_summary <- entrez_summary(db = "protein", web_history = search$web_history, retmax = 500)
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 1000, use_history = TRUE)
search_summary <- entrez_summary(db = "protein", web_history = search$web_history, retmax = 1000)
search_summary
search <- entrez_search("protein", term = "drosophila melanogaster[ORGN]", retmax = 1000, use_history = TRUE)
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = 500, retstart = seq_start, use_history = TRUE)
search
result <- foreach(seq_start = seq(1, 3600, 500), .combine = rbind) %do% {
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = 500, retstart = seq_start, use_history = TRUE)
# search_summary <- entrez_summary(db = "protein", id = search$ids)
search_summary <- entrez_summary(db = "protein", web_history = search$web_history,
retmax = 500)
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
a <- t(a)
a
}
result <- foreach(seq_start = seq(1, 1000, 500), .combine = rbind) %do% {
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = 500, retstart = seq_start, use_history = TRUE)
# search_summary <- entrez_summary(db = "protein", id = search$ids)
search_summary <- entrez_summary(db = "protein", web_history = search$web_history,
retmax = 500)
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
a <- t(a)
a
}
result
View(result)
result <- foreach(seq_start = seq(1, 1500, 500), .combine = rbind) %do% {
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = 500, retstart = seq_start, use_history = TRUE)
# search_summary <- entrez_summary(db = "protein", id = search$ids)
search_summary <- entrez_summary(db = "protein", web_history = search$web_history,
retmax = 500)
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
a <- t(a)
a
}
result <- as.data.frame(result)
colnames(result) <- c("AccessionNumber", "ProteinName")
View(result)
View(result)
a
colnames(a) <- c("AccessionNumber", "ProteinName")
View(a)
Translations = entrez_fetch("Protein", id = Proteins$AccessionNumber, rettype = "fasta")
Translations = unlist(strsplit(Translations, split = "\n\n"))
Translations = unlist(lapply(Translations, removeFastaHeader)) # Do this in parallel?
Proteins$Translations <- Translations # Pretty sure that columns match.
#for (i in 1:nrow(Proteins)) {
Proteins <- foreach(i = 1:nrow(Proteins), .combine = rbind) %do% {
nQs = str_count(Proteins$Translations[i], "Q")
Proteins$Qfraction[i] = nQs/nchar(Proteins$Translations[i])
Proteins[i,]
}
ProteinsHMMResult <- HiddenMarkov(Proteins)
ProteinsHMMResult
Proteins <- t(a)
colnames(Proteins) <- c("AccessionNumber", "ProteinName")
Translations = entrez_fetch("Protein", id = Proteins$AccessionNumber, rettype = "fasta")
a
View(a)
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
Proteins <- t(a)
View(Proteins)
colnames(Proteins) <- c("AccessionNumber", "ProteinName")
Translations = entrez_fetch("Protein", id = Proteins$AccessionNumber, rettype = "fasta")
Translations = unlist(strsplit(Translations, split = "\n\n"))
Translations = unlist(lapply(Translations, removeFastaHeader)) # Do this in parallel?
Proteins$Translations <- Translations # Pretty sure that columns match.
Proteins
a <- lapply(search_summary, my_func)
a <- as.data.frame(a)
Proteins <- t(a)
view(Proteins)
View(Proteins)
a <- lapply(search_summary, my_func)
Proteins <- t(a)
Proteins <- as.data.frame(Proteins)
colnames(Proteins) <- c("AccessionNumber", "ProteinName")
Translations = entrez_fetch("Protein", id = Proteins$AccessionNumber, rettype = "fasta")
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
Proteins <- t(a)
Proteins <- as.data.frame(Proteins)
colnames(Proteins) <- c("AccessionNumber", "ProteinName")
View(Proteins)
a <- lapply(search_summary, my_func)
View(a)
search <- entrez_search(db = "protein", term = "drosophila melanogaster[ORGN]",
retmax = 500, retstart = seq_start, use_history = TRUE)
search_summary <- entrez_summary(db = "protein", web_history = search$web_history,
retmax = 500)
my_func <- function(x) {return(c(x$caption, x$title))}
a <- lapply(search_summary, my_func)
View(a)
